<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>M3UPLAYER</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 2rem; background: #f0f0f0; }
    .container { max-width: 600px; margin: auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; }
    input { width: 100%; padding: 0.5rem; margin: 1rem 0; font-size: 1rem; }
    button { width: 48%; padding: 0.5rem; margin: 1%; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #0056b3; }
    p { text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h1>M3UPLAYER</h1>
    <input type="text" id="m3uUrl" placeholder="Enter M3U Playlist URL" value="https://hr.gogasecurityforce.com/1.m3u">
    <button onclick="saveM3U()">Save M3U URL</button>
    <button onclick="installInStremio()">Install in Stremio</button>
    <p id="message"></p>
  </div>
  <script>
    async function saveM3U() {
      const m3uUrl = document.getElementById('m3uUrl').value;
      const message = document.getElementById('message');
      if (!m3uUrl) {
        message.textContent = 'Please enter a valid M3U URL';
        return;
      }
      message.textContent = 'Saving...';
      try {
        const res = await fetch('/set-m3u', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ m3uUrl })
        });
        const result = await res.json();
        message.textContent = result.success ? 'M3U URL saved! Install in Stremio.' : `Error: ${result.error}`;
      } catch (e) {
        message.textContent = 'Server error. Try again.';
      }
    }

    function installInStremio() {
      const manifestUrl = 'stremio://m3uplayer.onrender.com/manifest.json';
      window.location.href = manifestUrl;
    }
  </script>
</body>
</html>
